# planner
- Аватары пользователей хранятся на gravatar.com. Получаем их по email пользователя. Чтобы получить аватар пользователя - нужно сделать запрос /api/user/get_avatar/{id}/{size}, где id - id пользователя, size - размер аватара, который хотим получить. 
  Если у пользователя нет зарегестрированного аккаунта на gravatar на email из нашей базы - будет 404 ошибка, иначе - вернется аватар пользователя.
- Изменения в БД: в src/main/resources/db/migration/ добавить sql файл с новой миграцией.
  Имена должны иметь вид V1__some_text.sql для первого скрипта, далее для второго V2__else_text.sql для второго и так далее.
  Миграции происходят при запуске сервиса.

Свойства в application.properties:
1. spring.session.jdbc.initialize-schema=always : spring создаст необходимые таблицы в БД
2. spring.session.jdbc.table-name=SPRING_SESSION : таблица для хранения сессий, сессии хранятся после перезапуска приложения
3. spring.jpa.hibernate.ddl-auto=validate : настройка для того, чтобы убедиться что сценарии базы данных, которые вы написали или применили к  инструменту миграции базы данных, точны (в продакшене  изменить значение на none)

Mail: 
1. mail.cron.daysToIDP : переменная, отвечающая за сколько дней пользователю и его начальству будет приходить напоминание об ИПР
2. mail.cron.timeTriggerIDP : регулярное выражение cron, отвечающее за то, как часто и в какое время будет проверяться, отправлены ли все сообщения об ИПР или нет  
3. mail.cron.subjectIDP : переменная, отвечающая за заголовок письма, которое будет отправлено пользователю и его начальству
4. mail.cron.textForUser : переменная. отвечающая за текст письма пользователю
5. mail.cron.textForManager : переменная. отвечающая за текст письма начальству пользователя

Docker:
- сборка проекта (при внесении изменений в проект) `mvn clean package`

- запуск docker (терминал указывает на папку docker) `docker-compose up`

- остановка `*ctrl + C*` + `docker-compose down`

Actuator:
1. Список всех эндпоинтов actuator: `/actuator`
2. Сведения о работоспособности приложения: `/actuator/health`
3. Дополнительная информация о приложении: `/actuator/info`
4. Список всех @ConfigurationProperties: `/actuator/configprops`
5. Свойства из ConfigurableEnvironment: `/actuator/env`
6. Миграции баз данных Flyway, которые были применены: `/actuator/flyway`

enable_notifications=true - включение отправки системных уведомлений для пользователя (для отключения enable_notifications=false)

Тесты:  
- mvn test -P unit : запуск только юнит тестов  
- mvn test -P IT : запуск только интеграционных тестов  


Анализатор кода:   

Для запуска анализатора кода нужно ввести команду mvn pmd:check, после этого будет сообщение об ошибке или успешной сборке, также будет построен отчет, в котором можно будет посмотреть все ошибки, в planner/target/site/pmd.html   
Правила для анализатора кода находятся в planner/rulesets   
Анализатор кода сообщает об ошибке, если импортированы классы из пакета проекта со " * ". Для того чтобы отключить автоматический импорт со " * ", нужно перейти: File -> Settings -> Editor -> Code Style -> Java и поставить побольше значение " Class count to import with '*' ".      

